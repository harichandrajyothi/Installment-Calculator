<!-- Installment Calculator - standalone HTML/CSS/JS -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Installment Scheduler</title>
  <style>
    :root{--bg:#f5f7fb;--card:#ffffff;--muted:#6b7280;--accent:#2563eb;--accent-2:#0ea5a4;--success:#16a34a}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial; margin:0;background:linear-gradient(180deg,var(--bg),#eef2ff);color:#0f172a}
    .container{max-width:1100px;margin:36px auto;padding:20px}
    header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:18px}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:1fr 1.2fr;gap:20px}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(16,24,40,0.06)}
    label{display:block;font-size:13px;color:#374151;margin-bottom:6px}
    .row{display:flex;gap:12px}
    input[type="number"], input[type="date"], select{width:100%;padding:10px 12px;border-radius:8px;border:1px solid #e6eef8;background:white;font-size:14px}
    input[type="radio"]{transform:scale(1.05);margin-right:8px}
    .small{font-size:12px;color:var(--muted)}
    .controls{display:flex;gap:10px;margin-top:12px}
    button{background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
    button.secondary{background:transparent;color:var(--accent);border:1px solid rgba(37,99,235,0.12)}
    .summary{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .stat{background:#f8fafc;padding:12px;border-radius:10px;min-width:140px}
    table{width:100%;border-collapse:collapse;margin-top:14px}
    th,td{padding:10px 8px;text-align:left;border-bottom:1px solid #eef2f7}
    th{font-size:13px;color:#111827}
    td.small{color:var(--muted);font-size:13px}

    /* responsive */
    @media(max-width:880px){.grid{grid-template-columns:1fr} .logo{display:none}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">IC</div>
      <div>
        <h1>Installment Scheduler</h1>
        <p class="lead">Enter amounts, choose frequency & start date — generate a full schedule and download as CSV.</p>
      </div>
    </header>

    <div class="grid">
      <div class="card" aria-labelledby="form-title">
        <h2 id="form-title" style="margin:0 0 12px 0">Inputs</h2>

        <div style="display:grid;gap:12px">
          <div>
            <label>Total amount (numeric)</label>
            <input id="total" type="number" min="0" step="0.01" value="488" />
          </div>

          <div style="display:flex;gap:8px;align-items:center;">
            <div style="flex:1">
              <label>Installment amount (leave blank if you prefer # installments)</label>
              <input id="perPayment" type="number" min="0" step="0.01" placeholder="e.g. 30" />
            </div>
            <div style="width:140px">
              <label>Or # Installments</label>
              <input id="count" type="number" min="1" step="1" placeholder="e.g. 8" />
            </div>
          </div>

          <div style="display:flex;gap:12px">
            <div style="flex:1">
              <label>Frequency</label>
              <select id="frequency">
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="fortnightly" selected>Fortnightly</option>
                <option value="monthly">Monthly</option>
              </select>
            </div>
            <div style="width:180px">
              <label>Start date</label>
              <input id="startDate" type="date" value="2025-10-01" />
            </div>
          </div>

          <div class="controls">
            <button id="generateBtn">Generate schedule</button>
            <button id="clearBtn" class="secondary">Reset</button>
            <button id="downloadBtn" class="secondary" style="margin-left:auto;">Download CSV</button>
          </div>

          <p class="small">Note: If you specify both an installment amount and number of installments, the <strong>installment amount</strong> will take precedence.</p>
        </div>
      </div>

      <div class="card">
        <h2 style="margin:0 0 12px 0">Schedule & Summary</h2>
        <div class="summary" id="summaryArea">
          <div class="stat"><div class="small">Total</div><div id="sTotal">$0.00</div></div>
          <div class="stat"><div class="small">Installments</div><div id="sCount">0</div></div>
          <div class="stat"><div class="small">Regular payment</div><div id="sPayment">$0.00</div></div>
          <div class="stat"><div class="small">Last payment date</div><div id="sLast">—</div></div>
        </div>

        <div id="tableWrap" style="margin-top:12px">
          <table id="scheduleTable" aria-live="polite">
            <thead>
              <tr><th>#</th><th>Due date</th><th>Amount</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Utility helpers
    const $ = id => document.getElementById(id)
    const formatMoney = v => '$' + Number(v).toFixed(2)

    function addDays(date, days){
      const d = new Date(date.getTime()); d.setDate(d.getDate() + days); return d;
    }

    function addMonths(date, months){
      const d = new Date(date.getTime());
      const day = d.getDate();
      d.setMonth(d.getMonth() + months);
      // handle month overflow (Feb 30 -> Mar 2 etc.)
      if (d.getDate() < day) d.setDate(0);
      return d;
    }

    function toIsoDateString(d){
      const y = d.getFullYear(); const m = String(d.getMonth()+1).padStart(2,'0'); const day = String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${day}`;
    }

    function prettyDate(d){
      return d.toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});
    }

    function computeSchedule({total, perPayment, count, frequency, startDate}){
      total = Number(total);
      perPayment = perPayment ? Number(perPayment) : null;
      count = count ? parseInt(count) : null;
      const schedule = [];
      let current = new Date(startDate.getTime());

      if (perPayment && perPayment > 0){
        const fullCount = Math.floor(total / perPayment);
        const remainder = +(total - (fullCount * perPayment)).toFixed(2);
        // create fullCount payments of perPayment
        for(let i=0;i<fullCount;i++){
          schedule.push({amount: +perPayment.toFixed(2), date: new Date(current.getTime())});
          current = advance(current, frequency);
        }
        if (remainder > 0.00001){
          schedule.push({amount: +remainder.toFixed(2), date: new Date(current.getTime())});
        }
      } else if (count && count > 0){
        const base = Math.floor((total / count) * 100) / 100; // two decimals floor
        let produced = 0;
        for(let i=0;i<count;i++){
          schedule.push({amount: base, date: new Date(current.getTime())});
          produced += base;
          current = advance(current, frequency);
        }
        // adjust remainder by adding the difference to the last installment
        const diff = +(total - produced).toFixed(2);
        if (Math.abs(diff) > 0.00001){
          schedule[schedule.length-1].amount = +(schedule[schedule.length-1].amount + diff).toFixed(2);
        }
      } else {
        // if neither provided, default to single payment
        schedule.push({amount: +total.toFixed(2), date: new Date(current.getTime())});
      }

      return schedule;
    }

    function advance(date, frequency){
      if (frequency === 'daily') return addDays(date,1);
      if (frequency === 'weekly') return addDays(date,7);
      if (frequency === 'fortnightly') return addDays(date,14);
      if (frequency === 'monthly') return addMonths(date,1);
      return addDays(date,14);
    }

    function renderSchedule(schedule){
      const tbody = document.querySelector('#scheduleTable tbody'); tbody.innerHTML = '';
      let total = 0;
      schedule.forEach((item,idx)=>{
        const tr = document.createElement('tr');
        const num = document.createElement('td'); num.textContent = idx+1;
        const date = document.createElement('td'); date.textContent = prettyDate(item.date);
        const amt = document.createElement('td'); amt.textContent = formatMoney(item.amount);
        tr.appendChild(num); tr.appendChild(date); tr.appendChild(amt);
        tbody.appendChild(tr);
        total += Number(item.amount);
      });

      // update summary
      $('sTotal').textContent = formatMoney(total);
      $('sCount').textContent = schedule.length;
      $('sPayment').textContent = schedule.length ? formatMoney(schedule[0].amount) : '$0.00';
      $('sLast').textContent = schedule.length ? prettyDate(schedule[schedule.length-1].date) : '—';
    }

    function downloadCSV(schedule){
      const header = ['Installment #','Due date','Amount'];
      const rows = schedule.map((r,i)=>[i+1,toIsoDateString(r.date),Number(r.amount).toFixed(2)]);
      const csv = [header].concat(rows).map(r=>r.map(c=>`"${String(c).replace(/"/g,'""')}"`).join(',')).join('\n');
      const blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'installment-schedule.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }

    // hookup
    document.getElementById('generateBtn').addEventListener('click', ()=>{
      const total = Number($('total').value) || 0;
      const perPayment = $('perPayment').value ? Number($('perPayment').value) : null;
      const count = $('count').value ? Number($('count').value) : null;
      const frequency = $('frequency').value;
      const sd = $('startDate').value;
      if (!sd){ alert('Please enter a valid start date'); return; }
      if (total <= 0){ alert('Please enter a total amount greater than zero'); return; }
      if (perPayment !== null && perPayment <= 0){ alert('Installment amount must be greater than zero if provided'); return; }
      if (count !== null && count <= 0){ alert('Number of installments must be at least 1'); return; }

      const startDate = new Date(sd + 'T00:00:00');
      const schedule = computeSchedule({total, perPayment, count, frequency, startDate});
      renderSchedule(schedule);
      // attach to download button
      window._lastSchedule = schedule;
    });

    $('clearBtn').addEventListener('click', ()=>{
      $('total').value = '';
      $('perPayment').value = '';
      $('count').value = '';
      $('frequency').value = 'fortnightly';
      $('startDate').value = '';
      document.querySelector('#scheduleTable tbody').innerHTML = '';
      $('sTotal').textContent = '$0.00'; $('sCount').textContent='0'; $('sPayment').textContent='$0.00'; $('sLast').textContent='—';
      window._lastSchedule = null;
    });

    $('downloadBtn').addEventListener('click', ()=>{
      const s = window._lastSchedule;
      if (!s || !s.length){ alert('No schedule to download. Please generate first.'); return; }
      downloadCSV(s);
    });

    // pre-generate from example values for convenience
    window.addEventListener('load', ()=>{
      // prefill example for the user: total 488, payment 30, fortnightly start 2025-10-01
      $('total').value = '488';
      $('perPayment').value = '30';
      $('frequency').value = 'fortnightly';
      $('startDate').value = '2025-10-01';
      document.getElementById('generateBtn').click();
    });
  </script>
</body>
</html>
